{
  "properties": {
    "description": {
      "description": "A description of the tariff.",
      "type": [
        "string",
        "null"
      ]
    },
    "displayName": {
      "description": "The name of the tariff.",
      "type": "string"
    },
    "endDate": {
      "description": "The end date of the application of the feed in tariff.",
      "type": [
        "string",
        "null"
      ],
      "x-cds-type": "DateString"
    },
    "payerType": {
      "description": "The type of the payer.",
      "enum": [
        "GOVERNMENT",
        "RETAILER"
      ],
      "type": "string"
    },
    "scheme": {
      "description": "The applicable scheme.",
      "enum": [
        "PREMIUM",
        "CURRENT",
        "VARIABLE",
        "OTHER"
      ],
      "type": "string"
    },
    "singleTariff": {
      "description": "Represents a constant tariff. Mandatory if _tariffUType_ is set to `singleTariff`.",
      "properties": {
        "period": {
          "default": "P1Y",
          "description": "Usage period for which the block rate applies. Formatted according to [ISO 8601 Durations](https://en.wikipedia.org/wiki/ISO_8601#Durations) (excludes recurrence syntax). Defaults to `P1Y` if absent.",
          "type": [
            "string",
            "null"
          ],
          "x-cds-type": "ExternalRef"
        },
        "rates": {
          "description": "Array of feed in rates.",
          "items": {
            "properties": {
              "measureUnit": {
                "allOf": [
                  {
                    "$ref": "MeasureUnitEnum.json"
                  }
                ],
                "default": "KWH",
                "description": "The measurement unit of rate. Assumed to be `KWH` if absent.",
                "type": "string"
              },
              "unitPrice": {
                "description": "Unit price of usage per measure unit (exclusive of GST).",
                "type": "string",
                "x-cds-type": "AmountString"
              },
              "volume": {
                "description": "Volume that this rate applies to. Only applicable for 'stepped' rates where different rates apply for different volumes of usage in a period.",
                "type": "number"
              }
            },
            "required": [
              "unitPrice"
            ],
            "type": "object"
          },
          "type": "array"
        }
      },
      "required": [
        "rates"
      ],
      "type": [
        "object",
        "null"
      ]
    },
    "startDate": {
      "description": "The start date of the application of the feed in tariff.",
      "type": [
        "string",
        "null"
      ],
      "x-cds-type": "DateString"
    },
    "tariffUType": {
      "description": "Reference to the applicable tariff structure.",
      "enum": [
        "singleTariff",
        "timeVaryingTariffs"
      ],
      "type": "string"
    },
    "timeVaryingTariffs": {
      "description": "Represents a tariff based on time of day. Mandatory if _tariffUType_ is set to `timeVaryingTariffs`.",
      "items": {
        "properties": {
          "displayName": {
            "description": "Display name of the tariff.",
            "type": "string"
          },
          "period": {
            "default": "P1Y",
            "description": "Usage period for which the block rate applies. Formatted according to [ISO 8601 Durations](https://en.wikipedia.org/wiki/ISO_8601#Durations) (excludes recurrence syntax). Defaults to `P1Y` if absent.",
            "type": "string",
            "x-cds-type": "ExternalRef"
          },
          "rates": {
            "description": "Array of feed in rates.",
            "items": {
              "properties": {
                "measureUnit": {
                  "allOf": [
                    {
                      "$ref": "MeasureUnitEnum.json"
                    }
                  ],
                  "default": "KWH",
                  "description": "The measurement unit of rate. Assumed to be `KWH` if absent.",
                  "type": "string"
                },
                "unitPrice": {
                  "description": "Unit price of usage per measure unit (exclusive of GST).",
                  "type": "string",
                  "x-cds-type": "AmountString"
                },
                "volume": {
                  "description": "Volume that this rate applies to. Only applicable for 'stepped' rates where different rates apply for different volumes of usage in a period.",
                  "type": "number"
                }
              },
              "required": [
                "unitPrice"
              ],
              "type": "object"
            },
            "type": "array"
          },
          "timeVariations": {
            "description": "Array of time windows for which this tariff is applicable.",
            "items": {
              "properties": {
                "days": {
                  "description": "The days that this time window applies to. At least one entry required.",
                  "items": {
                    "$ref": "EnergyDaysEnum.json"
                  },
                  "type": "array"
                },
                "endTime": {
                  "description": "The end of the time window per day for which the tariff applies. If absent assumes end of day (i.e. one second before midnight). Formatted according to [ISO 8601 Times](https://en.wikipedia.org/wiki/ISO_8601#Times). If the time is provided without a UTC offset, the time zone will be determined by the value of EnergyPlanContract.timeZone.",
                  "type": "string",
                  "x-cds-type": "ExternalRef"
                },
                "startTime": {
                  "description": "The beginning of the time window per day for which the tariff applies. If absent assumes start of day (i.e. midnight). Formatted according to [ISO 8601 Times](https://en.wikipedia.org/wiki/ISO_8601#Times). If the time is provided without a UTC offset, the time zone will be determined by the value of EnergyPlanContract.timeZone.",
                  "type": "string",
                  "x-cds-type": "ExternalRef"
                }
              },
              "required": [
                "days"
              ],
              "type": "object"
            },
            "type": "array"
          },
          "type": {
            "description": "The type of the charging time period. If absent applies to all periods.",
            "enum": [
              "PEAK",
              "OFF_PEAK",
              "SHOULDER"
            ],
            "type": "string"
          }
        },
        "required": [
          "timeVariations",
          "displayName"
        ],
        "type": "object"
      },
      "type": [
        "array",
        "null"
      ]
    }
  },
  "required": [
    "displayName",
    "scheme",
    "payerType",
    "tariffUType"
  ],
  "type": "object",
  "x-conditional": [
    "singleTariff",
    "timeVaryingTariffs"
  ],
    "allOf" : [
      {
        "if":   {"properties": {"tariffUType": { "const": "timeVaryingTariffs" }}},
        "then": { "required": ["timeVaryingTariffs"]}
      },
      {
        "if":   {  "properties": { "tariffUType" : {"const": "singleTariff"}}},
        "then": { "required": ["singleTariff"]}
      }  
    ]
}